#include <stddef.h>
#include <stdint.h>
#include <math.h>
#include "esp_log.h"
#include "freertos/FreeRTOS.h"
#include "freertos/queue.h"
#include "freertos/semphr.h"
#include "include/types.h"
#include "include/defines.h"
#include "include/handles.h"
#include "include/analysis.h"
#include "include/patterngen.h"

extern float AWeights[];
bool polar(float *in, float *out, size_t len)
{
	if (!(in && out && len%2==0)) return false;

	for (int i = 1; i < len/2; i++)
	{
		float re = in[i];
		float im = in[len-i];
		float mag = hypotf(re, im);
		float phase = atan2f(im, re);
		out[i] = mag;
		out[len-i] = phase;
	}
	return true;
}

float bisectAngle(float a, float b)
{
	float cx, cy;

	cx = cosf(a) + cosf(b);
	cy = sinf(a) + sinf(b);

	return atan2f(cy, cx);
}

bool averagechannels(float *r, float *l, float *out, size_t len)
{
	out[0] = (r[0] + l[0]) / 2.0f;
	out[len/2] = (r[len/2] + l[len/2]) / 2.0f;
	for (int i = 1; i < len/2; i++)
	{
		out[i] = (r[i] + l[i]) / 2.0f;
		out[len-i] = bisectAngle(r[len-i], l[len-i]);
	}
	return true;
}

bool AWeight(float *buf, size_t len)
{
	for (int i = 0; i < len/2; i++)
	{
		buf[i] *= AWeights[i];
	}
	return true;
}

//void AnalysisTask(void *ignored)
//{
//	for(;;)
//	{
//		pixel *buf = NULL;
//		pixel *rb = NULL;
//		pixel *VU = NULL;
//		pixel *ph = NULL;
//		pixel *df = NULL;
//
//		float *lhandle = NULL;
//		float *rhandle = NULL;
//
//		float *rainbowHandle = malloc(sizeof(float) * FFTLEN);
//
//		xQueueReceive(freqDataQueue, &lhandle, portMAX_DELAY);
//		xQueueReceive(freqDataQueue, &rhandle, portMAX_DELAY);
//
//		if (lhandle&&rhandle)
//		{
//			polar(lhandle, lhandle, FFTLEN);
//			polar(rhandle, rhandle, FFTLEN);
//			AWeight(lhandle, FFTLEN);
//			AWeight(rhandle, FFTLEN);
//
//			if (rainbowHandle)
//			{
//				averagechannels(lhandle, rhandle, rainbowHandle, FFTLEN);
//				rb = rainbow(rainbowHandle);
//			}
//
//			VU = VUMeter(lhandle, rhandle);
//			ph = phase(lhandle, rhandle);
//			df = difference(lhandle, rhandle);
//		}
//		if (lhandle) free(lhandle);
//		if (rhandle) free(rhandle);
//		lhandle = NULL;
//		rhandle = NULL;
//		if (rb)
//		{
//			xQueueReceive(LEDEmptyBufferQueue, &buf, portMAX_DELAY);
//			if (buf)
//			{
//				for ( int i = 0; i < NUMLEDS ; i++)
//				{
//					buf[i] = rb[i];
//				}
//				xQueueSendToBack(rainbowDataBufferQueue, &buf, portMAX_DELAY);
//			}
//			free(rb);
//			rb = NULL;
//		}
//		if (VU)
//		{
//			xQueueReceive(LEDEmptyBufferQueue, &buf, portMAX_DELAY);
//			if (buf)
//			{
//				for ( int i = 0; i < NUMLEDS ; i++)
//				{
//					buf[i] = VU[i];
//				}
//				xQueueSendToBack(VUMeterDataBufferQueue, &buf, portMAX_DELAY);
//			}
//			free(VU);
//			VU = NULL;
//		}
//		if (ph)
//		{
//			xQueueReceive(LEDEmptyBufferQueue, &buf, portMAX_DELAY);
//			if (buf)
//			{
//				for ( int i = 0; i < NUMLEDS ; i++)
//				{
//					buf[i] = ph[i];
//				}
//				xQueueSendToBack(diffDataBufferQueue, &buf, portMAX_DELAY);
//			}
//			free(ph);
//			ph = NULL;
//		}
//		if (df)
//		{
//			xQueueReceive(LEDEmptyBufferQueue, &buf, portMAX_DELAY);
//			if (buf)
//			{
//				for ( int i = 0; i < NUMLEDS ; i++)
//				{
//					buf[i] = df[i];
//				}
//				xQueueSendToBack(phaseDataBufferQueue, &buf, portMAX_DELAY);
//			}
//			free(df);
//			df = NULL;
//		}
//	}
//	vTaskDelete(NULL);
//	return;
//}

void HSVtoRGB(const HSVpixel *hsv, pixel *rgb)
{
	if (!(hsv && rgb)) return;
	if (hsv->saturation < 0.0001f)
	{
		rgb->red = rgb->green = rgb->blue = hsv->value*256;
		return;
	}
	float hue = hsv->hue;
	float sat = hsv->saturation;
	float val = hsv->value;

	if (hue < 0.0f)
	{
		int mult = (int)(hue/-360.0f) + 1;
		hue += 360.0f * (float) mult;
	}
	if (hue >= 360.0f) hue = fmodf(hue, 360.0f);
	if (sat < 0.0f) sat = 0.0f;
	if (sat > 1.0f) sat = 1.0f;
	if (val < 0.0f) val = 0.0f;
	if (val > 1.0f) val = 1.0f;

	float top = val;
	float bot = val * (1.0f - sat);
	float slope = 0.0f;
	float hd = fmodf(hue, 60.0f)/60.0f;
	int sextant = hue/60.0f;

	if (sextant & 1) slope = val*(1.0-(sat*hd));
	else slope = val*(1.0-sat*(1.0-hd));

	switch (sextant)
	{
		case 0:
			rgb->red = top*255.999;
			rgb->green = slope*255.999;
			rgb->blue = bot*255.999;
			break;
		case 1:
			rgb->red = slope*255.999;
			rgb->green = top*255.999;
			rgb->blue = bot*255.999;
			break;
		case 2:
			rgb->red = bot*255.999;
			rgb->green = top*255.999;
			rgb->blue = slope*255.999;
			break;
		case 3:
			rgb->red = bot*255.999;
			rgb->green = slope*255.999;
			rgb->blue = top*255.999;
			break;
		case 4:
			rgb->red = slope*255.999;
			rgb->green = bot*255.999;
			rgb->blue = top*255.999;
			break;
		case 5:
			rgb->red = top*255.999;
			rgb->green = bot*255.999;
			rgb->blue = slope*255.999;
			break;
	}
	return;
}

float AWeights[FFTLEN/2] = {
0.000392, 0.003759, 0.011242, 0.022163, 0.035723, 0.051261, 0.068239, 0.086226, 0.104885, 0.123958, 0.143252, 0.162624,
0.181970, 0.201217, 0.220310, 0.239211, 0.257893, 0.276336, 0.294527, 0.312457, 0.330119, 0.347508, 0.364621, 0.381457,
0.398015, 0.414293, 0.430293, 0.446014, 0.461458, 0.476625, 0.491516, 0.506134, 0.520479, 0.534554, 0.548361, 0.561901,
0.575178, 0.588194, 0.600951, 0.613452, 0.625700, 0.637698, 0.649449, 0.660957, 0.672225, 0.683255, 0.694052, 0.704620,
0.714961, 0.725079, 0.734979, 0.744663, 0.754136, 0.763402, 0.772463, 0.781324, 0.789989, 0.798461, 0.806745, 0.814843,
0.822760, 0.830500, 0.838065, 0.845460, 0.852689, 0.859754, 0.866660, 0.873410, 0.880006, 0.886454, 0.892756, 0.898914,
0.904933, 0.910816, 0.916566, 0.922185, 0.927677, 0.933045, 0.938292, 0.943420, 0.948432, 0.953331, 0.958119, 0.962800,
0.967375, 0.971848, 0.976219, 0.980493, 0.984671, 0.988756, 0.992749, 0.996653, 1.000471, 1.004203, 1.007852, 1.011420,
1.014908, 1.018320, 1.021656, 1.024918, 1.028109, 1.031229, 1.034280, 1.037265, 1.040183, 1.043038, 1.045830, 1.048562,
1.051233, 1.053846, 1.056402, 1.058903, 1.061349, 1.063741, 1.066082, 1.068372, 1.070612, 1.072804, 1.074948, 1.077046,
1.079098, 1.081106, 1.083070, 1.084992, 1.086873, 1.088712, 1.090512, 1.092273, 1.093996, 1.095681, 1.097330, 1.098944,
1.100522, 1.102066, 1.103577, 1.105054, 1.106500, 1.107914, 1.109297, 1.110650, 1.111974, 1.113268, 1.114534, 1.115772,
1.116983, 1.118168, 1.119325, 1.120458, 1.121565, 1.122647, 1.123705, 1.124740, 1.125751, 1.126739, 1.127705, 1.128648,
1.129570, 1.130471, 1.131352, 1.132212, 1.133051, 1.133871, 1.134672, 1.135454, 1.136217, 1.136963, 1.137690, 1.138399,
1.139091, 1.139766, 1.140425, 1.141067, 1.141693, 1.142303, 1.142897, 1.143476, 1.144040, 1.144590, 1.145124, 1.145645,
1.146151, 1.146643, 1.147122, 1.147588, 1.148040, 1.148479, 1.148906, 1.149320, 1.149722, 1.150111, 1.150489, 1.150855,
1.151209, 1.151551, 1.151883, 1.152203, 1.152513, 1.152812, 1.153100, 1.153378, 1.153646, 1.153903, 1.154151, 1.154388,
1.154616, 1.154835, 1.155044, 1.155244, 1.155435, 1.155616, 1.155789, 1.155953, 1.156109, 1.156256, 1.156394, 1.156525,
1.156647, 1.156761, 1.156867, 1.156965, 1.157056, 1.157139, 1.157214, 1.157282, 1.157343, 1.157397, 1.157443, 1.157482,
1.157514, 1.157540, 1.157558, 1.157570, 1.157575, 1.157574, 1.157566, 1.157552, 1.157532, 1.157505, 1.157472, 1.157433,
1.157389, 1.157338, 1.157281, 1.157219, 1.157150, 1.157076, 1.156997, 1.156912, 1.156822, 1.156726, 1.156624, 1.156518,
1.156406, 1.156289, 1.156167, 1.156040, 1.155908, 1.155771, 1.155629, 1.155482, 1.155331, 1.155174, 1.155013, 1.154848,
1.154678, 1.154503, 1.154324, 1.154140, 1.153952, 1.153759, 1.153562, 1.153361, 1.153156, 1.152947, 1.152733, 1.152515,
1.152294, 1.152068, 1.151838, 1.151604, 1.151367, 1.151125, 1.150880, 1.150631, 1.150378, 1.150121, 1.149861, 1.149597,
1.149329, 1.149058, 1.148783, 1.148505, 1.148224, 1.147938, 1.147650, 1.147358, 1.147062, 1.146764, 1.146462, 1.146156,
1.145848, 1.145536, 1.145221, 1.144903, 1.144582, 1.144258, 1.143930, 1.143600, 1.143266, 1.142930, 1.142590, 1.142248,
1.141902, 1.141554, 1.141203, 1.140849, 1.140492, 1.140132, 1.139770, 1.139405, 1.139037, 1.138666, 1.138293, 1.137917,
1.137538, 1.137157, 1.136773, 1.136386, 1.135997, 1.135606, 1.135212, 1.134815, 1.134416, 1.134014, 1.133610, 1.133204,
1.132795, 1.132383, 1.131970, 1.131554, 1.131135, 1.130714, 1.130291, 1.129866, 1.129439, 1.129009, 1.128577, 1.128142,
1.127706, 1.127267, 1.126826, 1.126383, 1.125938, 1.125491, 1.125041, 1.124590, 1.124136, 1.123681, 1.123223, 1.122763,
1.122302, 1.121838, 1.121372, 1.120905, 1.120435, 1.119963, 1.119490, 1.119014, 1.118537, 1.118058, 1.117577, 1.117094,
1.116609, 1.116122, 1.115634, 1.115143, 1.114651, 1.114157, 1.113661, 1.113164, 1.112665, 1.112164, 1.111661, 1.111157,
1.110651, 1.110143, 1.109633, 1.109122, 1.108609, 1.108095, 1.107579, 1.107061, 1.106542, 1.106021, 1.105499, 1.104974,
1.104449, 1.103922, 1.103393, 1.102863, 1.102331, 1.101797, 1.101263, 1.100726, 1.100188, 1.099649, 1.099108, 1.098566,
1.098022, 1.097477, 1.096931, 1.096383, 1.095833, 1.095283, 1.094731, 1.094177, 1.093622, 1.093066, 1.092508, 1.091949,
1.091389, 1.090828, 1.090265, 1.089700, 1.089135, 1.088568, 1.088000, 1.087431, 1.086860, 1.086288, 1.085715, 1.085141,
1.084565, 1.083988, 1.083410, 1.082831, 1.082251, 1.081669, 1.081086, 1.080502, 1.079917, 1.079331, 1.078744, 1.078155,
1.077565, 1.076975, 1.076383, 1.075790, 1.075196, 1.074600, 1.074004, 1.073407, 1.072808, 1.072209, 1.071608, 1.071006,
1.070404, 1.069800, 1.069195, 1.068590, 1.067983, 1.067375, 1.066766, 1.066157, 1.065546, 1.064934, 1.064321, 1.063708,
1.063093, 1.062477, 1.061861, 1.061243, 1.060625, 1.060006, 1.059386, 1.058764, 1.058142, 1.057519, 1.056896, 1.056271,
1.055645, 1.055019, 1.054392, 1.053763, 1.053134, 1.052504, 1.051874, 1.051242, 1.050610, 1.049976, 1.049342, 1.048708,
1.048072, 1.047436, 1.046798, 1.046160, 1.045521, 1.044882, 1.044242, 1.043600, 1.042959, 1.042316, 1.041673, 1.041028,
1.040384, 1.039738, 1.039092, 1.038445, 1.037797, 1.037149, 1.036500, 1.035850, 1.035199, 1.034548, 1.033896, 1.033244,
1.032590, 1.031937, 1.031282, 1.030627, 1.029971, 1.029315, 1.028658, 1.028000, 1.027341, 1.026682, 1.026023, 1.025363,
1.024702, 1.024041, 1.023379, 1.022716, 1.022053, 1.021389, 1.020725, 1.020060, 1.019394, 1.018728, 1.018062, 1.017395,
1.016727, 1.016059, 1.015390, 1.014721, 1.014051, 1.013381, 1.012710, 1.012039, 1.011367, 1.010695, 1.010022, 1.009348,
1.008675, 1.008000, 1.007326, 1.006650, 1.005975, 1.005298, 1.004622, 1.003945, 1.003267, 1.002589, 1.001911, 1.001232,
1.000553, 0.999873, 0.999193, 0.998512, 0.997831, 0.997150, 0.996468, 0.995786, 0.995103, 0.994420, 0.993737, 0.993053,
0.992369, 0.991685, 0.991000, 0.990314, 0.989629, 0.988943, 0.988257, 0.987570, 0.986883, 0.986195, 0.985508, 0.984820,
0.984131, 0.983443, 0.982754, 0.982064, 0.981375, 0.980685, 0.979994, 0.979304, 0.978613, 0.977922, 0.977230, 0.976538,
0.975846, 0.975154, 0.974461, 0.973769, 0.973075, 0.972382, 0.971688, 0.970994, 0.970300, 0.969606, 0.968911, 0.968216,
0.967521, 0.966826, 0.966130, 0.965434, 0.964738, 0.964042, 0.963345, 0.962649, 0.961952, 0.961254, 0.960557, 0.959860,
0.959162, 0.958464, 0.957766, 0.957067, 0.956369, 0.955670, 0.954971, 0.954272, 0.953573, 0.952874, 0.952174, 0.951475,
0.950775, 0.950075, 0.949375, 0.948674, 0.947974, 0.947274, 0.946573, 0.945872, 0.945171, 0.944470, 0.943769, 0.943068,
0.942366, 0.941665, 0.940963, 0.940261, 0.939559, 0.938857, 0.938155, 0.937453, 0.936751, 0.936049, 0.935346, 0.934644,
0.933941, 0.933239, 0.932536, 0.931833, 0.931130, 0.930427, 0.929724, 0.929021, 0.928318, 0.927615, 0.926912, 0.926209,
0.925505, 0.924802, 0.924099, 0.923395, 0.922692, 0.921989, 0.921285, 0.920582, 0.919878, 0.919175, 0.918471, 0.917768,
0.917064, 0.916360, 0.915657, 0.914953, 0.914250, 0.913546, 0.912843, 0.912139, 0.911436, 0.910732, 0.910029, 0.909325,
0.908622, 0.907918, 0.907215, 0.906512, 0.905808, 0.905105, 0.904402, 0.903699, 0.902995, 0.902292, 0.901589, 0.900886,
0.900183, 0.899480, 0.898778, 0.898075, 0.897372, 0.896670, 0.895967, 0.895264, 0.894562, 0.893860, 0.893157, 0.892455,
0.891753, 0.891051, 0.890349, 0.889647, 0.888946, 0.888244, 0.887543, 0.886841, 0.886140, 0.885439, 0.884738, 0.884037,
0.883336, 0.882635, 0.881934, 0.881234, 0.880533, 0.879833, 0.879133, 0.878433, 0.877733, 0.877033, 0.876333, 0.875634,
0.874935, 0.874235, 0.873536, 0.872837, 0.872139, 0.871440, 0.870741, 0.870043, 0.869345, 0.868647, 0.867949, 0.867251,
0.866554, 0.865857, 0.865159, 0.864462, 0.863766, 0.863069, 0.862372, 0.861676, 0.860980, 0.860284, 0.859588, 0.858893,
0.858197, 0.857502, 0.856807, 0.856112, 0.855418, 0.854723, 0.854029, 0.853335, 0.852641, 0.851948, 0.851254, 0.850561,
0.849868, 0.849175, 0.848483, 0.847790, 0.847098, 0.846406, 0.845715, 0.845023, 0.844332, 0.843641, 0.842950, 0.842260,
0.841569, 0.840879, 0.840189, 0.839500, 0.838811, 0.838121, 0.837433, 0.836744, 0.836056, 0.835367, 0.834680, 0.833992,
0.833305, 0.832617, 0.831931, 0.831244, 0.830558, 0.829872, 0.829186, 0.828500, 0.827815, 0.827130, 0.826445, 0.825761,
0.825076, 0.824392, 0.823709, 0.823025, 0.822342, 0.821659, 0.820977, 0.820295, 0.819613, 0.818931, 0.818250, 0.817568,
0.816888, 0.816207, 0.815527, 0.814847, 0.814167, 0.813488, 0.812809, 0.812130, 0.811452, 0.810774, 0.810096, 0.809418,
0.808741, 0.808064, 0.807387, 0.806711, 0.806035, 0.805359, 0.804684, 0.804009, 0.803334, 0.802660, 0.801986, 0.801312,
0.800639, 0.799966, 0.799293, 0.798620, 0.797948, 0.797276, 0.796605, 0.795934, 0.795263, 0.794592, 0.793922, 0.793253,
0.792583, 0.791914, 0.791245, 0.790577, 0.789909, 0.789241, 0.788574, 0.787906, 0.787240, 0.786573, 0.785907, 0.785242,
0.784576, 0.783911, 0.783247, 0.782583, 0.781919, 0.781255, 0.780592, 0.779929, 0.779267, 0.778605, 0.777943, 0.777282,
0.776621, 0.775960, 0.775300, 0.774640, 0.773980, 0.773321, 0.772662, 0.772004, 0.771346, 0.770688, 0.770031, 0.769374,
0.768718, 0.768062, 0.767406, 0.766750, 0.766095, 0.765441, 0.764787, 0.764133, 0.763479, 0.762826, 0.762173, 0.761521,
0.760869, 0.760218, 0.759567, 0.758916, 0.758265, 0.757615, 0.756966, 0.756317, 0.755668, 0.755020, 0.754372, 0.753724,
0.753077, 0.752430, 0.751784, 0.751138, 0.750492, 0.749847, 0.749202, 0.748558, 0.747914, 0.747270, 0.746627, 0.745985,
0.745342, 0.744700, 0.744059, 0.743418, 0.742777, 0.742137, 0.741497, 0.740857, 0.740218, 0.739580, 0.738942, 0.738304,
0.737667, 0.737030, 0.736393, 0.735757, 0.735121, 0.734486, 0.733851, 0.733217, 0.732583, 0.731949, 0.731316, 0.730684,
0.730051, 0.729419, 0.728788, 0.728157, 0.727526, 0.726896, 0.726267, 0.725637, 0.725009, 0.724380, 0.723752, 0.723125,
0.722498, 0.721871, 0.721245, 0.720619, 0.719993, 0.719369, 0.718744, 0.718120, 0.717496, 0.716873, 0.716250, 0.715628,
0.715006, 0.714385, 0.713764, 0.713143, 0.712523, 0.711904, 0.711285, 0.710666, 0.710047, 0.709430, 0.708812, 0.708195,
0.707579, 0.706963, 0.706347, 0.705732, 0.705117, 0.704503, 0.703889, 0.703276, 0.702663, 0.702050, 0.701438, 0.700827,
0.700216, 0.699605, 0.698995, 0.698385, 0.697776, 0.697167, 0.696558, 0.695951, 0.695343, 0.694736, 0.694129, 0.693523,
0.692918, 0.692313, 0.691708, 0.691104, 0.690500, 0.689896, 0.689293, 0.688691, 0.688089, 0.687488, 0.686887, 0.686286,
0.685686, 0.685086, 0.684487, 0.683888, 0.683290, 0.682692, 0.682095, 0.681498, 0.680902, 0.680306, 0.679710, 0.679115,
0.678521, 0.677926, 0.677333, 0.676740, 0.676147, 0.675555, 0.674963, 0.674372, 0.673781, 0.673191, 0.672601, 0.672011,
0.671422, 0.670834, 0.670246, 0.669658, 0.669071, 0.668485, 0.667899, 0.667313, 0.666728, 0.666143, 0.665559, 0.664975,
0.664392, 0.663809, 0.663227, 0.662645, 0.662064, 0.661483, 0.660902, 0.660322, 0.659743, 0.659164, 0.658585, 0.658007,
0.657430, 0.656852, 0.656276, 0.655700, 0.655124, 0.654549, 0.653974, 0.653400, 0.652826, 0.652253, 0.651680, 0.651108,
0.650536, 0.649964, 0.649393, 0.648823, 0.648253, 0.647683, 0.647114, 0.646546, 0.645978, 0.645410, 0.644843, 0.644277,
0.643710, 0.643145, 0.642580, 0.642015, 0.641451, 0.640887, 0.640324, 0.639761, 0.639198, 0.638637, 0.638075, 0.637514,
0.636954, 0.636394, 0.635835, 0.635276, 0.634717, 0.634159, 0.633602, 0.633045, 0.632488, 0.631932, 0.631377, 0.630821,
0.630267, 0.629713, 0.629159, 0.628606, 0.628053, 0.627501, 0.626949, 0.626398, 0.625847, 0.625297, 0.624747, 0.624198,
0.623649, 0.623100, 0.622552, 0.622005, 0.621458, 0.620912, 0.620366, 0.619820, 0.619275, 0.618731, 0.618187, 0.617643,
0.617100, 0.616557, 0.616015, 0.615473, 0.614932, 0.614392, 0.613851, 0.613312, 0.612772, 0.612234, 0.611695, 0.611158,
0.610620, 0.610083, 0.609547, 0.609011, 0.608476, 0.607941, 0.607406, 0.606873, 0.606339, 0.605806, 0.605274, 0.604742,
0.604210, 0.603679, 0.603148, 0.602618, 0.602089, 0.601559, 0.601031, 0.600503, 0.599975, 0.599448, 0.598921, 0.598395,
0.597869, 0.597343, 0.596819, 0.596294, 0.595770, 0.595247, 0.594724, 0.594202, 0.593680, 0.593158, 0.592637, 0.592117,
0.591597, 0.591077, 0.590558, 0.590039, 0.589521, 0.589003, 0.588486, 0.587970, 0.587453, 0.586938, 0.586422, 0.585908,
0.585393, 0.584879, 0.584366, 0.583853, 0.583341, 0.582829, 0.582317, 0.581806, 0.581296, 0.580786, 0.580276, 0.579767,
0.579258, 0.578750, 0.578243, 0.577735, 0.577229, 0.576723, 0.576217, 0.575711, 0.575207, 0.574702, 0.574198, 0.573695,
0.573192, 0.572690, 0.572188, 0.571686, 0.571185, 0.570685, 0.570185, 0.569685, 0.569186, 0.568687, 0.568189, 0.567691,
0.567194, 0.566697, 0.566201, 0.565705, 0.565210, 0.564715, 0.564220, 0.563726, 0.563233, 0.562740, 0.562247, 0.561755,
0.561264, 0.560772, 0.560282, 0.559792, 0.559302, 0.558813, 0.558324, 0.557835, 0.557348, 0.556860, 0.556373, 0.555887,
0.555401, 0.554915, 0.554430, 0.553946, 0.553461, 0.552978, 0.552495, 0.552012, 0.551530, 0.551048, 0.550566, 0.550086,
0.549605, 0.549125, 0.548646, 0.548167, 0.547688, 0.547210, 0.546732, 0.546255, 0.545778, 0.545302, 0.544826, 0.544351,
0.543876, 0.543402, 0.542928, 0.542454, 0.541981, 0.541509, 0.541037, 0.540565, 0.540094, 0.539623, 0.539153, 0.538683,
0.538214, 0.537745, 0.537276, 0.536808, 0.536341, 0.535874, 0.535407, 0.534941, 0.534475, 0.534010, 0.533545, 0.533081,
0.532617, 0.532154, 0.531691, 0.531228, 0.530766, 0.530304, 0.529843, 0.529383, 0.528922, 0.528463, 0.528003, 0.527544,
0.527086, 0.526628, 0.526170, 0.525713, 0.525257, 0.524801, 0.524345, 0.523890, 0.523435, 0.522980, 0.522526, 0.522073,
0.521620, 0.521167, 0.520715, 0.520263, 0.519812, 0.519361, 0.518911, 0.518461, 0.518012, 0.517563, 0.517114, 0.516666,
0.516218, 0.515771, 0.515324, 0.514878, 0.514432, 0.513987, 0.513542, 0.513097, 0.512653, 0.512209, 0.511766, 0.511323,
0.510881, 0.510439, 0.509997, 0.509556, 0.509116, 0.508676, 0.508236, 0.507797, 0.507358, 0.506919, 0.506481, 0.506044,
0.505607, 0.505170, 0.504734, 0.504298, 0.503863, 0.503428, 0.502994, 0.502559, 0.502126, 0.501693, 0.501260, 0.500828,
0.500396, 0.499964, 0.499533, 0.499103, 0.498673, 0.498243, 0.497814, 0.497385, 0.496957, 0.496529, 0.496101, 0.495674,
0.495247, 0.494821, 0.494395, 0.493970, 0.493545, 0.493120, 0.492696, 0.492273, 0.491849, 0.491427, 0.491004, 0.490582,
0.490161, 0.489740, 0.489319, 0.488899, 0.488479, 0.488059, 0.487641, 0.487222, 0.486804, 0.486386, 0.485969, 0.485552,
0.485136, 0.484720, 0.484304, 0.483889, 0.483474, 0.483060, 0.482646, 0.482232, 0.481819, 0.481407, 0.480994, 0.480582,
0.480171, 0.479760, 0.479350, 0.478939, 0.478530, 0.478120, 0.477711, 0.477303, 0.476895, 0.476487, 0.476080, 0.475673,
0.475267, 0.474861, 0.474455, 0.474050, 0.473645, 0.473241, 0.472837, 0.472434, 0.472030, 0.471628, 0.471225, 0.470824,
0.470422, 0.470021, 0.469620, 0.469220, 0.468820, 0.468421, 0.468022, 0.467623, 0.467225, 0.466827, 0.466430, 0.466033,
0.465637, 0.465240, 0.464845, 0.464449, 0.464054, 0.463660, 0.463266, 0.462872, 0.462479, 0.462086, 0.461693, 0.461301,
0.460909, 0.460518, 0.460127, 0.459737, 0.459347, 0.458957, 0.458567, 0.458179, 0.457790, 0.457402, 0.457014, 0.456627,
0.456240, 0.455853, 0.455467, 0.455082, 0.454696, 0.454311, 0.453927, 0.453543, 0.453159, 0.452776, 0.452393, 0.452010,
0.451628, 0.451246, 0.450865, 0.450484, 0.450103, 0.449723, 0.449343, 0.448964, 0.448585, 0.448206, 0.447828, 0.447450,
0.447072, 0.446695, 0.446318, 0.445942, 0.445566, 0.445191, 0.444816, 0.444441, 0.444066, 0.443692, 0.443319, 0.442946,
0.442573, 0.442200, 0.441828, 0.441456, 0.441085, 0.440714, 0.440344, 0.439974, 0.439604, 0.439234, 0.438865, 0.438497,
0.438129, 0.437761, 0.437393, 0.437026, 0.436659, 0.436293, 0.435927, 0.435561, 0.435196, 0.434831, 0.434467, 0.434103,
0.433739, 0.433376, 0.433013, 0.432650, 0.432288, 0.431926, 0.431565, 0.431204, 0.430843, 0.430483, 0.430123, 0.429763,
0.429404, 0.429045, 0.428686, 0.428328, 0.427971, 0.427613, 0.427256, 0.426900, 0.426543, 0.426187, 0.425832, 0.425477,
0.425122, 0.424768, 0.424414, 0.424060, 0.423707, 0.423354, 0.423001, 0.422649, 0.422297, 0.421945, 0.421594, 0.421244,
0.420893, 0.420543, 0.420193, 0.419844, 0.419495, 0.419147, 0.418798, 0.418451, 0.418103, 0.417756, 0.417409, 0.417063,
0.416717, 0.416371, 0.416026, 0.415681, 0.415336, 0.414992, 0.414648, 0.414304, 0.413961, 0.413618, 0.413276, 0.412933,
0.412592, 0.412250, 0.411909, 0.411568, 0.411228, 0.410888, 0.410548, 0.410209, 0.409870, 0.409532, 0.409193, 0.408855,
0.408518, 0.408181, 0.407844, 0.407507, 0.407171, 0.406835, 0.406500, 0.406165, 0.405830, 0.405496, 0.405162, 0.404828,
0.404494, 0.404161, 0.403829, 0.403496, 0.403164, 0.402833, 0.402501, 0.402171, 0.401840, 0.401510, 0.401180, 0.400850,
0.400521, 0.400192, 0.399863, 0.399535, 0.399207, 0.398880, 0.398553, 0.398226, 0.397899, 0.397573, 0.397247, 0.396922,
0.396597, 0.396272, 0.395947, 0.395623, 0.395299, 0.394976, 0.394653, 0.394330, 0.394007, 0.393685, 0.393363, 0.393042,
0.392721, 0.392400, 0.392080, 0.391759, 0.391440, 0.391120, 0.390801, 0.390482, 0.390164, 0.389846, 0.389528, 0.389210,
0.388893, 0.388576, 0.388260, 0.387944, 0.387628, 0.387312, 0.386997, 0.386682, 0.386368, 0.386053, 0.385740, 0.385426,
0.385113, 0.384800, 0.384487, 0.384175, 0.383863, 0.383551, 0.383240, 0.382929, 0.382619, 0.382308, 0.381998, 0.381689,
0.381379, 0.381070, 0.380762, 0.380453, 0.380145, 0.379837, 0.379530, 0.379223, 0.378916, 0.378610, 0.378303, 0.377998,
0.377692, 0.377387, 0.377082, 0.376777, 0.376473, 0.376169, 0.375866, 0.375562, 0.375259, 0.374957, 0.374654, 0.374352,
0.374050, 0.373749, 0.373448, 0.373147, 0.372847, 0.372546, 0.372246, 0.371947, 0.371648, 0.371349, 0.371050, 0.370752,
0.370454, 0.370156, 0.369859, 0.369562, 0.369265, 0.368968, 0.368672, 0.368376, 0.368081, 0.367786, 0.367491, 0.367196,
0.366902, 0.366608, 0.366314, 0.366021, 0.365727, 0.365435, 0.365142, 0.364850, 0.364558, 0.364266, 0.363975, 0.363684,
0.363393, 0.363103, 0.362813, 0.362523, 0.362234, 0.361945, 0.361656, 0.361367, 0.361079, 0.360791, 0.360503, 0.360216,
0.359929, 0.359642, 0.359355, 0.359069, 0.358783, 0.358498, 0.358212, 0.357927, 0.357642, 0.357358, 0.357074, 0.356790,
0.356506, 0.356223, 0.355940, 0.355658, 0.355375, 0.355093, 0.354811, 0.354530, 0.354249, 0.353968, 0.353687, 0.353407,
0.353127, 0.352847, 0.352567, 0.352288, 0.352009, 0.351731, 0.351452, 0.351174, 0.350896, 0.350619, 0.350342, 0.350065,
0.349788, 0.349512, 0.349236, 0.348960, 0.348685, 0.348409, 0.348135, 0.347860, 0.347586, 0.347312, 0.347038, 0.346764,
0.346491, 0.346218, 0.345946, 0.345673, 0.345401, 0.345129, 0.344858, 0.344586, 0.344316, 0.344045, 0.343774, 0.343504,
0.343234, 0.342965, 0.342696, 0.342427, 0.342158, 0.341889, 0.341621, 0.341353, 0.341086, 0.340818, 0.340551, 0.340284,
0.340018, 0.339752, 0.339486, 0.339220, 0.338954, 0.338689, 0.338424, 0.338160, 0.337895, 0.337631, 0.337367, 0.337104,
0.336841, 0.336578, 0.336315, 0.336053, 0.335790, 0.335528, 0.335267, 0.335005, 0.334744, 0.334483, 0.334223, 0.333963,
0.333702, 0.333443, 0.333183, 0.332924, 0.332665, 0.332406, 0.332148, 0.331890, 0.331632, 0.331374, 0.331117, 0.330860,
0.330603, 0.330346, 0.330090, 0.329834, 0.329578, 0.329322, 0.329067, 0.328812, 0.328557, 0.328303, 0.328049, 0.327795,
0.327541, 0.327287, 0.327034, 0.326781, 0.326529, 0.326276, 0.326024, 0.325772, 0.325520, 0.325269, 0.325018, 0.324767,
0.324516, 0.324266, 0.324016, 0.323766, 0.323516, 0.323267, 0.323018, 0.322769, 0.322521, 0.322272, 0.322024, 0.321776,
0.321529, 0.321282, 0.321034, 0.320788, 0.320541, 0.320295, 0.320049, 0.319803, 0.319557, 0.319312, 0.319067, 0.318822,
0.318578, 0.318333, 0.318089, 0.317846, 0.317602, 0.317359, 0.317116, 0.316873, 0.316630, 0.316388, 0.316146, 0.315904,
0.315662, 0.315421, 0.315180, 0.314939, 0.314699, 0.314458, 0.314218, 0.313978, 0.313739, 0.313499, 0.313260, 0.313021,
0.312783, 0.312544, 0.312306, 0.312068, 0.311830, 0.311593, 0.311356, 0.311119, 0.310882, 0.310646, 0.310409, 0.310173,
0.309938, 0.309702, 0.309467, 0.309232, 0.308997, 0.308762, 0.308528, 0.308294, 0.308060, 0.307827, 0.307593, 0.307360,
0.307127, 0.306894, 0.306662, 0.306430, 0.306198, 0.305966, 0.305735, 0.305503, 0.305272, 0.305042, 0.304811, 0.304581,
0.304351, 0.304121, 0.303891, 0.303662, 0.303433, 0.303204, 0.302975, 0.302747, 0.302518, 0.302290, 0.302062, 0.301835,
0.301608, 0.301381, 0.301154, 0.300927, 0.300701, 0.300475, 0.300249, 0.300023, 0.299797, 0.299572, 0.299347, 0.299122,
0.298898, 0.298673, 0.298449, 0.298225, 0.298002, 0.297778, 0.297555, 0.297332, 0.297109, 0.296887, 0.296664, 0.296442,
0.296220, 0.295999, 0.295777, 0.295556, 0.295335, 0.295114, 0.294894, 0.294674 };
